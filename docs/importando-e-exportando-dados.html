<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Curso de R para Meteorologia IAG/USP</title>
  <meta name="description" content="Este é um curso de R para Meteorologia. O curso tenta ser abrangente, desde interessados sem formação, passando por graduação e pós-graduação">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Curso de R para Meteorologia IAG/USP" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este é um curso de R para Meteorologia. O curso tenta ser abrangente, desde interessados sem formação, passando por graduação e pós-graduação" />
  <meta name="github-repo" content="iagdevs/cursoR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Curso de R para Meteorologia IAG/USP" />
  
  <meta name="twitter:description" content="Este é um curso de R para Meteorologia. O curso tenta ser abrangente, desde interessados sem formação, passando por graduação e pós-graduação" />
  

<meta name="author" content="Sergio Ibarra-Espinosa, Amanda Rehbein, Daniel Schuch, Camila Lopes, Isabela Siqueira, e possivelmente outros (você está convidado para colaborar)">


<meta name="date" content="2018-06-06">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="r.html">
<link rel="next" href="plotando.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Curso R DCA/IAG/USP</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Pré-Requisitos</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#sistema-operacional"><i class="fa fa-check"></i><b>1.1</b> Sistema Operacional</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#pacotes-usados-neste-curso"><i class="fa fa-check"></i><b>1.2</b> Pacotes usados neste curso</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#dados-usados-neste-curso"><i class="fa fa-check"></i><b>1.3</b> Dados usados neste curso</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#colaborar"><i class="fa fa-check"></i><b>1.4</b> Colaborar</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#compartilhar-dados"><i class="fa fa-check"></i><b>1.5</b> Compartilhar dados</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Intro</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#importante"><i class="fa fa-check"></i><b>2.1</b> IMPORTANTE</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>3</b> R!</a><ul>
<li class="chapter" data-level="3.1" data-path="r.html"><a href="r.html#variaveis-basicas"><i class="fa fa-check"></i><b>3.1</b> Variáveis Básicas</a></li>
<li class="chapter" data-level="3.2" data-path="r.html"><a href="r.html#vetores"><i class="fa fa-check"></i><b>3.2</b> Vetores</a></li>
<li class="chapter" data-level="3.3" data-path="r.html"><a href="r.html#classe"><i class="fa fa-check"></i><b>3.3</b> Classe</a></li>
<li class="chapter" data-level="3.4" data-path="r.html"><a href="r.html#converter-objetos"><i class="fa fa-check"></i><b>3.4</b> Converter objetos</a><ul>
<li class="chapter" data-level="3.4.1" data-path="r.html"><a href="r.html#as"><i class="fa fa-check"></i><b>3.4.1</b> <code>as</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="r.html"><a href="r.html#convert_df"><i class="fa fa-check"></i><b>3.4.2</b> <code>merge</code> e <code>melt</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="r.html"><a href="r.html#array"><i class="fa fa-check"></i><b>3.5</b> Array</a></li>
<li class="chapter" data-level="3.6" data-path="r.html"><a href="r.html#matrizes-e-a-funcao-matrix"><i class="fa fa-check"></i><b>3.6</b> Matrizes e a função <code>matrix</code></a></li>
<li class="chapter" data-level="3.7" data-path="r.html"><a href="r.html#listas"><i class="fa fa-check"></i><b>3.7</b> Listas</a></li>
<li class="chapter" data-level="3.8" data-path="r.html"><a href="r.html#dataframes"><i class="fa fa-check"></i><b>3.8</b> Data Frames</a></li>
<li class="chapter" data-level="3.9" data-path="r.html"><a href="r.html#tempo-e-data"><i class="fa fa-check"></i><b>3.9</b> Tempo e Data</a></li>
<li class="chapter" data-level="3.10" data-path="r.html"><a href="r.html#fatores"><i class="fa fa-check"></i><b>3.10</b> Fatores</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html"><i class="fa fa-check"></i><b>4</b> Importando e Exportando Dados</a><ul>
<li class="chapter" data-level="4.1" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#base"><i class="fa fa-check"></i><b>4.1</b> Base</a><ul>
<li class="chapter" data-level="4.1.1" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#importando-com-read."><i class="fa fa-check"></i><b>4.1.1</b> Importando com <code>read.*</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#exportando-com-write.table"><i class="fa fa-check"></i><b>4.1.2</b> Exportando com <code>write.table</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#exportando-objetos-com-save"><i class="fa fa-check"></i><b>4.1.3</b> Exportando objetos com <code>save</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#exportando-objetos-com-saverds"><i class="fa fa-check"></i><b>4.1.4</b> Exportando objetos com <code>saveRDS</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#processing_dfs"><i class="fa fa-check"></i><b>4.1.5</b> Processando nossa data frame</a></li>
<li class="chapter" data-level="4.1.6" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#data.table-e-mais"><i class="fa fa-check"></i><b>4.1.6</b> Data.Table e mais</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#tidyverse"><i class="fa fa-check"></i><b>4.2</b> Tidyverse</a><ul>
<li class="chapter" data-level="4.2.1" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#importando-dados"><i class="fa fa-check"></i><b>4.2.1</b> Importando dados</a></li>
<li class="chapter" data-level="4.2.2" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#leitura-processamento"><i class="fa fa-check"></i><b>4.2.2</b> Leitura <code>%&gt;%</code> Processamento</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#outros-tipos-de-dados"><i class="fa fa-check"></i><b>4.3</b> Outros Tipos de Dados</a><ul>
<li class="chapter" data-level="4.3.1" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#netcdf"><i class="fa fa-check"></i><b>4.3.1</b> NetCDF</a></li>
<li class="chapter" data-level="4.3.2" data-path="importando-e-exportando-dados.html"><a href="importando-e-exportando-dados.html#dados-binarios"><i class="fa fa-check"></i><b>4.3.2</b> Dados Binários</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotando.html"><a href="plotando.html"><i class="fa fa-check"></i><b>5</b> Plotando</a><ul>
<li class="chapter" data-level="5.1" data-path="plotando.html"><a href="plotando.html#plot-base"><i class="fa fa-check"></i><b>5.1</b> <code>plot</code> (base)</a></li>
<li class="chapter" data-level="5.2" data-path="plotando.html"><a href="plotando.html#ggplot-ggplot2"><i class="fa fa-check"></i><b>5.2</b> <code>ggplot</code> (ggplot2)</a><ul>
<li class="chapter" data-level="5.2.1" data-path="plotando.html"><a href="plotando.html#explorando-outras-escalas-de-cores-e-temas"><i class="fa fa-check"></i><b>5.2.1</b> Explorando outras escalas de cores e temas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="loop.html"><a href="loop.html"><i class="fa fa-check"></i><b>6</b> Estruturas de Controle</a><ul>
<li class="chapter" data-level="6.1" data-path="loop.html"><a href="loop.html#if-else"><i class="fa fa-check"></i><b>6.1</b> if-else</a></li>
<li class="chapter" data-level="6.2" data-path="loop.html"><a href="loop.html#for"><i class="fa fa-check"></i><b>6.2</b> for</a></li>
<li class="chapter" data-level="6.3" data-path="loop.html"><a href="loop.html#while"><i class="fa fa-check"></i><b>6.3</b> while</a></li>
<li class="chapter" data-level="6.4" data-path="loop.html"><a href="loop.html#repeat"><i class="fa fa-check"></i><b>6.4</b> repeat</a></li>
<li class="chapter" data-level="6.5" data-path="loop.html"><a href="loop.html#lapply"><i class="fa fa-check"></i><b>6.5</b> lapply</a></li>
<li class="chapter" data-level="6.6" data-path="loop.html"><a href="loop.html#sapply"><i class="fa fa-check"></i><b>6.6</b> sapply</a></li>
<li class="chapter" data-level="6.7" data-path="loop.html"><a href="loop.html#split"><i class="fa fa-check"></i><b>6.7</b> split</a></li>
<li class="chapter" data-level="6.8" data-path="loop.html"><a href="loop.html#tapply"><i class="fa fa-check"></i><b>6.8</b> tapply</a></li>
<li class="chapter" data-level="6.9" data-path="loop.html"><a href="loop.html#apply"><i class="fa fa-check"></i><b>6.9</b> apply</a></li>
<li class="chapter" data-level="6.10" data-path="loop.html"><a href="loop.html#mapply"><i class="fa fa-check"></i><b>6.10</b> mapply</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fx.html"><a href="fx.html"><i class="fa fa-check"></i><b>7</b> De Scripts a Funções e de Funções a Pacotes</a></li>
<li class="chapter" data-level="8" data-path="geo.html"><a href="geo.html"><i class="fa fa-check"></i><b>8</b> Geo Spatial: <code>raster</code>, <code>sf</code> e <code>stars</code></a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referências</a></li>
<li class="divider"></li>
<li><a href="https://iagdevs.github.io/cursoR" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Curso de R para Meteorologia IAG/USP</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="importando-e-exportando-dados" class="section level1">
<h1><span class="header-section-number">Capítulo 4</span> Importando e Exportando Dados</h1>
<div id="base" class="section level2">
<h2><span class="header-section-number">4.1</span> Base</h2>
<div id="importando-com-read." class="section level3">
<h3><span class="header-section-number">4.1.1</span> Importando com <code>read.*</code></h3>
<p>Como vimos anteriormente, na maioria dos casos, iremos usar data frames par lidar com dados em R, sendo assim, podemos utilizar os seguintes modos de leitura:</p>
<ul>
<li><code>read.csv</code><br />
</li>
<li><code>read.csv2</code><br />
</li>
<li><code>read.table</code></li>
</ul>
<p>Vamos ler alguns dados usando <code>read.table</code>. Para saber o que a função faz, use <code>?read.table</code>.<br />
Os argumentos da função são:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(read.table)</code></pre></div>
<pre><code>## function (file, header = FALSE, sep = &quot;&quot;, quote = &quot;\&quot;&#39;&quot;, dec = &quot;.&quot;, 
##     numerals = c(&quot;allow.loss&quot;, &quot;warn.loss&quot;, &quot;no.loss&quot;), row.names, 
##     col.names, as.is = !stringsAsFactors, na.strings = &quot;NA&quot;, 
##     colClasses = NA, nrows = -1, skip = 0, check.names = TRUE, 
##     fill = !blank.lines.skip, strip.white = FALSE, blank.lines.skip = TRUE, 
##     comment.char = &quot;#&quot;, allowEscapes = FALSE, flush = FALSE, 
##     stringsAsFactors = default.stringsAsFactors(), fileEncoding = &quot;&quot;, 
##     encoding = &quot;unknown&quot;, text, skipNul = FALSE) 
## NULL</code></pre>
<p>O terceiro argumento é <code>sep</code>, definido como <code>&quot;&quot;</code> por padrão. Esse argumento indica para o R qual o tipo de separador utilizado entre as colunas dos dados.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;dados/NOXIPEN2014.txt&quot;</span>)</code></pre></div>
<p>Lembre-se que as funções <code>head</code> e <code>tail</code> permitem que você veja as primeiras ou últimas linhas do data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df)</code></pre></div>
<pre><code>##    TipodeRede TipodeMonitoramento             Tipo       Data  Hora
## 2 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 01:00
## 3 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 02:00
## 4 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 03:00
## 5 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 04:00
## 6 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 05:00
## 7 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 06:00
##   CodigoEstaÃ.Ã.o               NomeEstaÃ.Ã.o               NomeParÃ.metro
## 2              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 3              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 4              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 5              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 6              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 7              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
##   UnidadedeMedida MediaHoraria MediaMovel Valido
## 2             ppb            9          -   NÃ£o
## 3             ppb            9          -    Sim
## 4             ppb            5          -    Sim
## 5             ppb            4          -    Sim
## 6             ppb            5          -    Sim
## 7             ppb            5          -    Sim</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(df)</code></pre></div>
<pre><code>##       TipodeRede TipodeMonitoramento             Tipo       Data  Hora
## 8577 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 19:00
## 8578 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 20:00
## 8579 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 21:00
## 8580 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 22:00
## 8581 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 23:00
## 8582 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 24:00
##      CodigoEstaÃ.Ã.o               NomeEstaÃ.Ã.o
## 8577              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8578              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8579              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8580              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8581              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8582              95 Cid.UniversitÃ¡ria-USP-Ipen
##                    NomeParÃ.metro UnidadedeMedida MediaHoraria MediaMovel
## 8577 NOx (Ã“xidos de NitrogÃªnio)             ppb            3          -
## 8578 NOx (Ã“xidos de NitrogÃªnio)             ppb            8          -
## 8579 NOx (Ã“xidos de NitrogÃªnio)             ppb           11          -
## 8580 NOx (Ã“xidos de NitrogÃªnio)             ppb           11          -
## 8581 NOx (Ã“xidos de NitrogÃªnio)             ppb           16          -
## 8582 NOx (Ã“xidos de NitrogÃªnio)             ppb           NA          -
##      Valido
## 8577    Sim
## 8578    Sim
## 8579    Sim
## 8580    Sim
## 8581    Sim
## 8582    Sim</code></pre>
<p>Vamos tentar ler outra versão dos mesmos dados utilizando a mesma função <code>read.table</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df2 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;dados/NOXIPEN2014v2.txt&quot;</span>)</code></pre></div>
<pre><code>## Error in scan(file = file, what = what, sep = sep, quote = quote, dec = dec, : linha 1 não tinha 6 elementos</code></pre>
<p>Apareceu uma mensagem de erro, <span style="color:blue">você saberia dizer o porquê?</span></p>
<p><strong>Caso você trabalhe com algum banco de dados em formato .txt e quiser abrir no R… Abra-os no bloco de notas primeiro!</strong></p>
<p>Vamos dar uma olhada em alguns dados, o primeiro tem uma cara assim:</p>
<p><img src="figuras/f1.png" width="665" /></p>
<p>Já o segundo arquivo é assim:</p>
<p><img src="figuras/f2.png" width="552" /></p>
<p>Você notou a diferença? Como vimos anteriormente, para importar os dados no R é super importante que você especifique o tipo de separador utilizado. Como o segundo arquivo é separado por “;”, precisamos espercificar o argumento <code>sep</code> na hora de usar o comando <code>read.table</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df2 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;dados/NOXIPEN2014v2.txt&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)
<span class="kw">head</span>(df2)</code></pre></div>
<pre><code>##    TipodeRede TipodeMonitoramento             Tipo       Data  Hora
## 2 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 01:00
## 3 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 02:00
## 4 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 03:00
## 5 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 04:00
## 6 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 05:00
## 7 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 06:00
##   CodigoEstaÃ.Ã.o               NomeEstaÃ.Ã.o               NomeParÃ.metro
## 2              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 3              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 4              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 5              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 6              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 7              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
##   UnidadedeMedida MediaHoraria MediaMovel Valido
## 2             ppb            9          -   NÃ£o
## 3             ppb            9          -    Sim
## 4             ppb            5          -    Sim
## 5             ppb            4          -    Sim
## 6             ppb            5          -    Sim
## 7             ppb            5          -    Sim</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(df2)</code></pre></div>
<pre><code>##       TipodeRede TipodeMonitoramento             Tipo       Data  Hora
## 8577 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 19:00
## 8578 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 20:00
## 8579 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 21:00
## 8580 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 22:00
## 8581 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 23:00
## 8582 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2015 24:00
##      CodigoEstaÃ.Ã.o               NomeEstaÃ.Ã.o
## 8577              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8578              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8579              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8580              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8581              95 Cid.UniversitÃ¡ria-USP-Ipen
## 8582              95 Cid.UniversitÃ¡ria-USP-Ipen
##                    NomeParÃ.metro UnidadedeMedida MediaHoraria MediaMovel
## 8577 NOx (Ã“xidos de NitrogÃªnio)             ppb            3          -
## 8578 NOx (Ã“xidos de NitrogÃªnio)             ppb            8          -
## 8579 NOx (Ã“xidos de NitrogÃªnio)             ppb           11          -
## 8580 NOx (Ã“xidos de NitrogÃªnio)             ppb           11          -
## 8581 NOx (Ã“xidos de NitrogÃªnio)             ppb           16          -
## 8582 NOx (Ã“xidos de NitrogÃªnio)             ppb           NA          -
##      Valido
## 8577    Sim
## 8578    Sim
## 8579    Sim
## 8580    Sim
## 8581    Sim
## 8582    Sim</code></pre>
<p>Além desses comandos, vocês também pode utilizar a opção <strong>Import Dataset</strong> do RStudio, permitindo que você tenha um “preview” dos dados - como no Excel, mas melhor!</p>
<p>Para mais informações sobre importar dados no R, dê uma olha nesse <a href="https://www.rstudio.com/resources/webinars/importing-data-into-r/">webnário</a>.</p>
</div>
<div id="exportando-com-write.table" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Exportando com <code>write.table</code></h3>
<p>Exportar é bem facil. Vamos dar uma olhada nos argumentos da função <code>write.table</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(write.table)</code></pre></div>
<pre><code>## function (x, file = &quot;&quot;, append = FALSE, quote = TRUE, sep = &quot; &quot;, 
##     eol = &quot;\n&quot;, na = &quot;NA&quot;, dec = &quot;.&quot;, row.names = TRUE, col.names = TRUE, 
##     qmethod = c(&quot;escape&quot;, &quot;double&quot;), fileEncoding = &quot;&quot;) 
## NULL</code></pre>
<p>Se temos um data frame com colunas de classe character, <code>quote = TRUE</code> quer dizer que o arquivo de texto resultante vai ter aspas nas colunas de caractere. Novamente, o argumento <code>sep</code> indica como podemos separar as colunas. Se você quiser abrir esses dados no excel, uma boa opção é utilizar os separadores “,”/“;”/&quot; “/”“, sendo o último o separador que indica o espaçamento criado pela tecla TAB.</p>
<p>Já o argumento <code>eol</code> quer dizer <em>end of line</em>, e é uma forma de dizer ao R que a linha acaba ali. Por padrão, a opção <code>row.names</code> vem com a opção TRUE, mas sempre coloque a opção FALSE, caso contrário, será adicionada uma coluna com os índices das linhas. O argumento <code>col.names</code> indica se você quer nomear as suas colunas, o que é sempre uma boa ideia.</p>
<hr />
<p><span style="color:red"><strong>Exercício</strong>: Usando o conjunto de dados <code>mtcars</code> da base do R, exporte-o de uma forma que ele possa ser lido em algum Excel genérico. Não esqueça de usar o que foi ensinado acima.</p>
<hr />
</div>
<div id="exportando-objetos-com-save" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Exportando objetos com <code>save</code></h3>
<p>Podemos salvar objetos do R com o comando <code>save</code>. Ele permite que você recarregue o objeto mais tarde.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(save)</code></pre></div>
<pre><code>## function (..., list = character(), file = stop(&quot;&#39;file&#39; must be specified&quot;), 
##     ascii = FALSE, version = NULL, envir = parent.frame(), compress = isTRUE(!ascii), 
##     compression_level, eval.promises = TRUE, precheck = TRUE) 
## NULL</code></pre>
<p>Essa função salva o objeto com a extensão .rda sendo que para carregá-lo de volta usamos a função <code>load</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(load)</code></pre></div>
<pre><code>## function (file, envir = parent.frame(), verbose = FALSE) 
## NULL</code></pre>
<p>Muito cuidado ao utilizar esse comando, pois é bem possível cometer alguns deslizes, como trocar o nome do objeto. Veja esse exemplo abaixo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Primeiro vamos ler os dados do dia 01/06/2016 para uma estação automática do INMET de Paracatu:</span>
paracatu &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;dados/paracatu.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>) <span class="co">#lendo como csv</span>

<span class="co"># Vamos dizer que queremos salvar apenas a coluna correspondente à temperatura máxima horária:</span>
paracatu_temp &lt;-<span class="st"> </span>paracatu<span class="op">$</span>temp_max  

<span class="co">#Agora vamos salvar o objeto do tipo numeric com o nome especificado:</span>
<span class="kw">save</span>(paracatu_temp, <span class="dt">file =</span> <span class="st">&quot;Temp_max.rda&quot;</span>)</code></pre></div>
<p>Passado um tempo, queremos acessar de volta esse objeto, mas não lembramos se salvamos a temperatura máxima ou mínima, vamos confiar que foi a mínima:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;Temp_min.rda&quot;</span>)</code></pre></div>
<p>E assim descobrimos que não era… O que nos ensina a sempre guardar na memória quais variáveis que salvamos no ambiente R. O bom dessa função é que ela permite salvar com tipos de compressão, por exemplo <code>compress = &quot;xz&quot;</code>.</p>
</div>
<div id="exportando-objetos-com-saverds" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Exportando objetos com <code>saveRDS</code></h3>
<p>Esta é uma das minhas funçoes favoritas no R, veja só o porquê:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">saveRDS</span>(paracatu_temp, <span class="st">&quot;Temperatura.rds&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">frenteQ &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;Temperatura.rds&quot;</span>)</code></pre></div>
<p>Você pode salvar seu objeto R de forma serializada e compactada com o argumento <code>compress</code> e na hora de chamar o objeto de volta é só usar <code>readRDS</code> e colocar o nome que você quiser.</p>
</div>
<div id="processing_dfs" class="section level3">
<h3><span class="header-section-number">4.1.5</span> Processando nossa data frame</h3>
<p>Vamos revisar a classe de cada coluna do nosso data-frame com a função <code>sapply</code>, que será explicada em outro capítulo. Lembre-se, qualquer dúvida é só usar <code>?sapply</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(df, class)</code></pre></div>
<pre><code>##          TipodeRede TipodeMonitoramento                Tipo 
##            &quot;factor&quot;            &quot;factor&quot;            &quot;factor&quot; 
##                Data                Hora     CodigoEstaÃ.Ã.o 
##            &quot;factor&quot;            &quot;factor&quot;           &quot;integer&quot; 
##       NomeEstaÃ.Ã.o      NomeParÃ.metro     UnidadedeMedida 
##            &quot;factor&quot;            &quot;factor&quot;            &quot;factor&quot; 
##        MediaHoraria          MediaMovel              Valido 
##           &quot;integer&quot;            &quot;factor&quot;            &quot;factor&quot;</code></pre>
<p>Quando trabalhamos com séries temporais, é importante ter a variável tempo reconhecida como “tempo”, especificamente como classe “POSIXct”. Porém, a classe do tipo Data é “factor” assim como a Hora, o que pode ser ruim. Então, vamos criar uma variável de tempo mais padronizada com o formato 2018-06-06 00:12:41.</p>
<p>Para isso temos que juntar as variáveis Data e Hora. Faremos isso numa nova varável chamada “tempo_char”, adicionando-a diretamente no data frame com o cifrão (“$”). Podemos fazer isso com as funções <code>paste</code> ou <code>paste0</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>tempo_char &lt;-<span class="st"> </span><span class="kw">paste</span>(df<span class="op">$</span>Data, df<span class="op">$</span>Hora)
<span class="kw">head</span>(df<span class="op">$</span>tempo_char)</code></pre></div>
<pre><code>## [1] &quot;01/01/2014 01:00&quot; &quot;01/01/2014 02:00&quot; &quot;01/01/2014 03:00&quot;
## [4] &quot;01/01/2014 04:00&quot; &quot;01/01/2014 05:00&quot; &quot;01/01/2014 06:00&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(df<span class="op">$</span>tempo_char)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Melhorou, mas ainda tem clase character.</p>
<p>Para converter a nossa classe para POSIXct podemos usar a função <code>as.POSIXct</code> (olhe<br />
<code>?as.POSIXct</code>). Seus argumentos são:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(as.POSIXct)</code></pre></div>
<pre><code>## function (x, tz = &quot;&quot;, ...) 
## NULL</code></pre>
<p>Então, vamos criar outra variável tempo com o formato POSIXct:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>tempo &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="dt">x =</span> df<span class="op">$</span>tempo_char, <span class="dt">tz =</span> <span class="st">&quot;Americas/Sao_Paulo&quot;</span>, 
                       <span class="dt">format =</span> <span class="st">&quot;%d/%m/%Y %H:%M&quot;</span>)</code></pre></div>
<pre><code>## Warning in strptime(x, format, tz = tz): unknown timezone &#39;Americas/
## Sao_Paulo&#39;</code></pre>
<pre><code>## Warning in as.POSIXct.POSIXlt(as.POSIXlt(x, tz, ...), tz, ...): unknown
## timezone &#39;Americas/Sao_Paulo&#39;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df<span class="op">$</span>tempo)</code></pre></div>
<pre><code>## Warning in as.POSIXlt.POSIXct(x, tz): unknown timezone &#39;Americas/Sao_Paulo&#39;</code></pre>
<pre><code>## [1] &quot;2014-01-01 01:00:00 GMT&quot; &quot;2014-01-01 02:00:00 GMT&quot;
## [3] &quot;2014-01-01 03:00:00 GMT&quot; &quot;2014-01-01 04:00:00 GMT&quot;
## [5] &quot;2014-01-01 05:00:00 GMT&quot; &quot;2014-01-01 06:00:00 GMT&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(df<span class="op">$</span>tempo)</code></pre></div>
<pre><code>## [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</code></pre>
<p>Agora, vamos extrair os dias da semana do tempo, mes e dia juliano:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>weekdays &lt;-<span class="st"> </span><span class="kw">format</span>(df<span class="op">$</span>tempo, <span class="st">&quot;%A&quot;</span>)</code></pre></div>
<pre><code>## Warning in as.POSIXlt.POSIXct(x, tz): unknown timezone &#39;Americas/Sao_Paulo&#39;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df<span class="op">$</span>weekdays)</code></pre></div>
<pre><code>## [1] &quot;quarta-feira&quot; &quot;quarta-feira&quot; &quot;quarta-feira&quot; &quot;quarta-feira&quot;
## [5] &quot;quarta-feira&quot; &quot;quarta-feira&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>mes &lt;-<span class="st"> </span><span class="kw">format</span>(df<span class="op">$</span>tempo, <span class="st">&quot;%B&quot;</span>)</code></pre></div>
<pre><code>## Warning in as.POSIXlt.POSIXct(x, tz): unknown timezone &#39;Americas/Sao_Paulo&#39;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df<span class="op">$</span>mes)</code></pre></div>
<pre><code>## [1] &quot;janeiro&quot; &quot;janeiro&quot; &quot;janeiro&quot; &quot;janeiro&quot; &quot;janeiro&quot; &quot;janeiro&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>diajuliano &lt;-<span class="st"> </span><span class="kw">julian</span>(df<span class="op">$</span>tempo)
<span class="kw">head</span>(df<span class="op">$</span>diajuliano)</code></pre></div>
<pre><code>## Time differences in days
## [1] 16071.04 16071.08 16071.12 16071.17 16071.21 16071.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>ano &lt;-<span class="st"> </span><span class="kw">format</span>(df<span class="op">$</span>tempo, <span class="st">&quot;%Y&quot;</span>)</code></pre></div>
<pre><code>## Warning in as.POSIXlt.POSIXct(x, tz): unknown timezone &#39;Americas/Sao_Paulo&#39;</code></pre>
<p>Pronto! Agora temos o tempo no formato que desejamos.</p>
<div id="aggregate" class="section level4">
<h4><span class="header-section-number">4.1.5.1</span> <code>aggregate</code></h4>
<p>Vamos dar uma olhada no nosso data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df)</code></pre></div>
<pre><code>## Warning in as.POSIXlt.POSIXct(x, tz): unknown timezone &#39;Americas/Sao_Paulo&#39;</code></pre>
<pre><code>##    TipodeRede TipodeMonitoramento             Tipo       Data  Hora
## 2 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 01:00
## 3 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 02:00
## 4 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 03:00
## 5 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 04:00
## 6 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 05:00
## 7 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 06:00
##   CodigoEstaÃ.Ã.o               NomeEstaÃ.Ã.o               NomeParÃ.metro
## 2              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 3              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 4              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 5              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 6              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 7              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
##   UnidadedeMedida MediaHoraria MediaMovel Valido       tempo_char
## 2             ppb            9          -   NÃ£o 01/01/2014 01:00
## 3             ppb            9          -    Sim 01/01/2014 02:00
## 4             ppb            5          -    Sim 01/01/2014 03:00
## 5             ppb            4          -    Sim 01/01/2014 04:00
## 6             ppb            5          -    Sim 01/01/2014 05:00
## 7             ppb            5          -    Sim 01/01/2014 06:00
##                 tempo     weekdays     mes    diajuliano  ano
## 2 2014-01-01 01:00:00 quarta-feira janeiro 16071.04 days 2014
## 3 2014-01-01 02:00:00 quarta-feira janeiro 16071.08 days 2014
## 4 2014-01-01 03:00:00 quarta-feira janeiro 16071.12 days 2014
## 5 2014-01-01 04:00:00 quarta-feira janeiro 16071.17 days 2014
## 6 2014-01-01 05:00:00 quarta-feira janeiro 16071.21 days 2014
## 7 2014-01-01 06:00:00 quarta-feira janeiro 16071.25 days 2014</code></pre>
<p>Com a função <code>aggregate</code>, podemos agregar os dados de diversas formas. Por exemplo, a média horaria por dia da semana é:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dff &lt;-<span class="st"> </span><span class="kw">aggregate</span>(df<span class="op">$</span>MediaHoraria, <span class="dt">by =</span> <span class="kw">list</span>(df<span class="op">$</span>weekdays), mean, <span class="dt">na.rm =</span> T)
<span class="kw">names</span>(dff) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dias&quot;</span>, <span class="st">&quot;MediaHoraria&quot;</span>)
dff</code></pre></div>
<pre><code>##            dias MediaHoraria
## 1       domingo     17.32907
## 2  quarta-feira     34.07973
## 3  quinta-feira     33.65931
## 4        sábado     27.30178
## 5 segunda-feira     28.93543
## 6   sexta-feira     35.40599
## 7   terça-feira     32.04057</code></pre>
<p>E o desvio-padrão é:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dff<span class="op">$</span>sd &lt;-<span class="st"> </span><span class="kw">aggregate</span>(df<span class="op">$</span>MediaHoraria, <span class="dt">by =</span> <span class="kw">list</span>(df<span class="op">$</span>weekdays), sd, <span class="dt">na.rm =</span> T)<span class="op">$</span>x
dff</code></pre></div>
<pre><code>##            dias MediaHoraria       sd
## 1       domingo     17.32907 22.11278
## 2  quarta-feira     34.07973 41.26901
## 3  quinta-feira     33.65931 42.14773
## 4        sábado     27.30178 35.08044
## 5 segunda-feira     28.93543 32.15303
## 6   sexta-feira     35.40599 44.44488
## 7   terça-feira     32.04057 33.87323</code></pre>
<hr />
<p><span style="color:red"><strong>Exercício</strong>: <strong>Em média</strong>, como o NOx varia ao longo do dia de acordo com esses dados? Qual a amplitude diária?</span></p>
<hr />
</div>
<div id="subset" class="section level4">
<h4><span class="header-section-number">4.1.5.2</span> <code>subset</code></h4>
<p>Como podemos escolher só o mês de janeiro??</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#[ LINHAS , COLUNAS ]</span>
<span class="kw">head</span>(df[df<span class="op">$</span>mes <span class="op">==</span><span class="st"> &quot;janeiro&quot;</span>, ]) <span class="co">#TODAS AS COLUNAS</span></code></pre></div>
<pre><code>## Warning in as.POSIXlt.POSIXct(x, tz): unknown timezone &#39;Americas/Sao_Paulo&#39;</code></pre>
<pre><code>##    TipodeRede TipodeMonitoramento             Tipo       Data  Hora
## 2 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 01:00
## 3 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 02:00
## 4 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 03:00
## 5 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 04:00
## 6 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 05:00
## 7 AutomÃ¡tico              CETESB Dados PrimÃ¡rios 01/01/2014 06:00
##   CodigoEstaÃ.Ã.o               NomeEstaÃ.Ã.o               NomeParÃ.metro
## 2              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 3              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 4              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 5              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 6              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
## 7              95 Cid.UniversitÃ¡ria-USP-Ipen NOx (Ã“xidos de NitrogÃªnio)
##   UnidadedeMedida MediaHoraria MediaMovel Valido       tempo_char
## 2             ppb            9          -   NÃ£o 01/01/2014 01:00
## 3             ppb            9          -    Sim 01/01/2014 02:00
## 4             ppb            5          -    Sim 01/01/2014 03:00
## 5             ppb            4          -    Sim 01/01/2014 04:00
## 6             ppb            5          -    Sim 01/01/2014 05:00
## 7             ppb            5          -    Sim 01/01/2014 06:00
##                 tempo     weekdays     mes    diajuliano  ano
## 2 2014-01-01 01:00:00 quarta-feira janeiro 16071.04 days 2014
## 3 2014-01-01 02:00:00 quarta-feira janeiro 16071.08 days 2014
## 4 2014-01-01 03:00:00 quarta-feira janeiro 16071.12 days 2014
## 5 2014-01-01 04:00:00 quarta-feira janeiro 16071.17 days 2014
## 6 2014-01-01 05:00:00 quarta-feira janeiro 16071.21 days 2014
## 7 2014-01-01 06:00:00 quarta-feira janeiro 16071.25 days 2014</code></pre>
<p>Só que agora temos só a média horária para esse mês, que retorna um vetor numérico:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(df)</code></pre></div>
<pre><code>##  [1] &quot;TipodeRede&quot;          &quot;TipodeMonitoramento&quot; &quot;Tipo&quot;               
##  [4] &quot;Data&quot;                &quot;Hora&quot;                &quot;CodigoEstaÃ.Ã.o&quot;    
##  [7] &quot;NomeEstaÃ.Ã.o&quot;       &quot;NomeParÃ.metro&quot;      &quot;UnidadedeMedida&quot;    
## [10] &quot;MediaHoraria&quot;        &quot;MediaMovel&quot;          &quot;Valido&quot;             
## [13] &quot;tempo_char&quot;          &quot;tempo&quot;               &quot;weekdays&quot;           
## [16] &quot;mes&quot;                 &quot;diajuliano&quot;          &quot;ano&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df[df<span class="op">$</span>mes <span class="op">==</span><span class="st"> &quot;janeiro&quot;</span>, <span class="dv">10</span>]) </code></pre></div>
<pre><code>## [1] 9 9 5 4 5 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df[df<span class="op">$</span>mes <span class="op">==</span><span class="st"> &quot;janeiro&quot;</span>, <span class="st">&quot;MediaHoraria&quot;</span>])</code></pre></div>
<pre><code>## [1] 9 9 5 4 5 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(df[df<span class="op">$</span>mes <span class="op">==</span><span class="st"> &quot;janeiro&quot;</span>, <span class="st">&quot;MediaHoraria&quot;</span>])</code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<hr />
<p><span style="color:red"><strong>Exercício</strong>: <strong>Em média</strong>, como o NOx varia ao longo do dia em Julho? E em Dezembro?</span></p>
<hr />
<p>Vamos salvar nosso data frame para depois fazer gráficos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">saveRDS</span>(df, <span class="st">&quot;dados/df.rds&quot;</span>)</code></pre></div>
</div>
</div>
<div id="data.table-e-mais" class="section level3">
<h3><span class="header-section-number">4.1.6</span> Data.Table e mais</h3>
<p>O data.table é um pacote que apresenta a classe <code>data.table</code>, que é como uma versão melhorada da classe <code>data.frame</code> O termo especifico é que <code>data.table</code> tem um “parentesco” (inherits) com a classe <code>data.frame</code>.</p>
<p>Vamos ver como funciona data.table lendo os dois arquivos e comparar quanto tempo demora cada um. A função de leitura do data.table é <code>fread</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df1 &lt;-<span class="st"> </span><span class="kw">print</span>(<span class="kw">system.time</span>(<span class="kw">read.table</span>(<span class="st">&quot;dados/NOXIPEN2014.txt&quot;</span>, <span class="dt">h =</span> T)))</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.09    0.00    0.09</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
df2 &lt;-<span class="st"> </span><span class="kw">print</span>(<span class="kw">system.time</span>(<span class="kw">fread</span>(<span class="st">&quot;dados/NOXIPEN2014.txt&quot;</span>, <span class="dt">h =</span> T)))</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.02    0.00    0.02</code></pre>
</div>
</div>
<div id="tidyverse" class="section level2">
<h2><span class="header-section-number">4.2</span> Tidyverse</h2>
<p>Um método mais recente (e muito interessante!) de tratar data frames é usando os pacotes dentro do <a href="https://www.tidyverse.org/">Tidyverse</a>.<br />
Usando diversas funções dos pacotes <strong>readr</strong>, <strong>tidyr</strong> e <strong>dplyr</strong>, por exemplo, é possível ler e processar dados de uma maneira mais <em>user-friendly</em> devido à sintaxe das funções e de como elas podem ser usadas em conjunto.<br />
Assim como o data.table tem uma classe própria, as funções dentro do tidyverse costumam trabalhar com sua própria classe, que é o <code>tibble</code> (ou <code>tbl_df</code>) - <em>que segundo <a href="https://github.com/tidyverse/tibble">os desenvolvedores</a> são <code>data.frames</code> preguiçosos e mal-humorados. Isso pode parecer ruim, mas na verdade é bom pois exige funções “mais espertas” para lidar com eles</em>. Ainda assim é possível trabalhar com data frames sem dificuldades.<br />
Note que muitas das funções usadas abaixo podem ser encontradas em Base ou em outros pacotes associados.</p>
<div id="importando-dados" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Importando dados</h3>
<p>Todas as funções de leitura possuem a mesma estrutura:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">read_<span class="op">*</span>(arquivo, 
       <span class="dt">col_names =</span> <span class="ot">TRUE</span>, 
       <span class="dt">col_types =</span> <span class="ot">NULL</span>, 
       <span class="dt">locale =</span> <span class="kw">default_locale</span>(), 
       <span class="dt">na =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;NA&quot;</span>),
       <span class="dt">quoted_na =</span> <span class="ot">TRUE</span>, 
       <span class="dt">comment =</span> <span class="st">&quot;&quot;</span>, 
       <span class="dt">trim_ws =</span> <span class="ot">TRUE</span>, 
       <span class="dt">skip =</span> <span class="dv">0</span>, 
       <span class="dt">n_max =</span> <span class="ot">Inf</span>, 
       <span class="dt">guess_max =</span> <span class="kw">min</span>(<span class="dv">1000</span>, n_max), <span class="dt">progress =</span> <span class="kw">interactive</span>())</code></pre></div>
<p><em>Dica/Lembrete: Quando a descrição de uma função mostra os argumentos já definidos (<code>col_names = TRUE</code>), isso significa que esses são os valores padrão e que você não precisa escrever os argumentos se não quiser mudá-los</em></p>
<p>Assim, todas as funções de leitura só precisam do nome do arquivo!</p>
<p>Então como ler diferentes arquivos? Usando diferentes funções.</p>
<ul>
<li><code>read_csv</code> lê arquivos .csv <strong>separados por <span class="math inline">\(,\)</span></strong><br />
</li>
<li><code>read_csv2</code> lê arquivos .csv <strong>separados por <span class="math inline">\(;\)</span></strong><br />
</li>
<li><code>read_delim</code> lê arquivos <strong>com outros separadores</strong> (definidos com o argumento <code>delim</code>)<br />
</li>
<li><code>read_fwf</code> lê arquivos <strong>com delimitação fixa</strong> (definidos com o argumento <code>col_positions</code>)<br />
</li>
<li><code>read_xl</code> lê arquivos <strong>Excel</strong> (.xls e .xlsx)</li>
</ul>
<p>Assim, para ler os dados de Paracatu do INMET:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
paracatu &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;dados/paracatu.csv&quot;</span>)
<span class="kw">summary</span>(paracatu)</code></pre></div>
<pre><code>##  codigo_estacao         data               hora             temp_inst    
##  Length:24          Length:24          Length:24          Min.   :14.50  
##  Class :character   Class :character   Class :character   1st Qu.:16.25  
##  Mode  :character   Mode  :character   Mode  :character   Median :19.40  
##                                                           Mean   :20.04  
##                                                           3rd Qu.:24.32  
##                                                           Max.   :26.40  
##     temp_max        temp_min      umid_inst           umid_max        
##  Min.   :15.50   Min.   :14.20   Length:24          Length:24         
##  1st Qu.:17.15   1st Qu.:15.38   Class :character   Class :character  
##  Median :19.75   Median :18.15   Mode  :character   Mode  :character  
##  Mean   :20.78   Mean   :19.26                                        
##  3rd Qu.:24.98   3rd Qu.:23.38                                        
##  Max.   :27.20   Max.   :26.20                                        
##    umid_min         pto_orvalho_inst   pto_orvalho_max   
##  Length:24          Length:24          Length:24         
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character  
##                                                          
##                                                          
##                                                          
##  pto_orvalho_min       pressao       pressao_max     pressao_min   
##  Length:24          Min.   :934.0   Min.   :934.1   Min.   :933.9  
##  Class :character   1st Qu.:934.7   1st Qu.:934.8   1st Qu.:934.4  
##  Mode  :character   Median :935.1   Median :935.4   Median :934.9  
##                     Mean   :935.3   Mean   :935.6   Mean   :935.1  
##                     3rd Qu.:935.6   3rd Qu.:936.0   3rd Qu.:935.4  
##                     Max.   :937.6   Max.   :937.7   Max.   :937.4  
##  vento_direcao     vento_vel       vento_rajada     radiacao      
##  Min.   :0.300   Min.   : 14.00   Min.   :0.80   Min.   :  -3.60  
##  1st Qu.:0.600   1st Qu.: 77.75   1st Qu.:1.85   1st Qu.:  -3.60  
##  Median :1.350   Median :209.00   Median :2.80   Median :  21.03  
##  Mean   :1.567   Mean   :177.96   Mean   :3.30   Mean   : 713.77  
##  3rd Qu.:2.450   3rd Qu.:256.00   3rd Qu.:4.60   3rd Qu.:1483.50  
##  Max.   :4.100   Max.   :355.00   Max.   :6.70   Max.   :2642.00  
##   precipitacao
##  Min.   :0    
##  1st Qu.:0    
##  Median :0    
##  Mean   :0    
##  3rd Qu.:0    
##  Max.   :0</code></pre>
</div>
<div id="leitura-processamento" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Leitura <code>%&gt;%</code> Processamento</h3>
<p>Existem funções de leitura e modificação de data frames. Muitas vezes, você precisa lidar com dados “brutos” e que precisam de um certo processamento antes de serem utilizados em cálculos e gráficos. Como vimos anteriormente, isso exige no mínimo duas funções em duas linhas de código (uma para ler e outra para modificar), mas em geral esse processo precisa de bem mais do que isso.</p>
<p>O operador <a href="http://r4ds.had.co.nz/pipes.html"><code>%&gt;%</code></a>) (chamada de <em>pipe</em>) está dentro do pacote magnittr (dentro do Tidyverse) e é muito útil nesse processo! (<a href="https://www.datacamp.com/community/tutorials/pipe-r-tutorial">Leia um pouco sobre ele aqui</a>)</p>
<p>Como ele funciona?</p>
<blockquote>
<p>variável %&gt;% função1(., faz a modificação 1) %&gt;% função2(., faz a modificação 2) %&gt;% … %&gt;% funçãon(., faz a modificação n)</p>
</blockquote>
<p>O ponto (.) acima indica que a função será aplicada na versão da variável que chega nela.<br />
Em notação matemática, podemos dizer que <span class="math inline">\(x \ \ \%&gt;\% \ \ f(y) = f(x,y)\)</span>.<br />
Por exemplo, observe o código abaixo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)

<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">order</span>(., <span class="dt">decreasing =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">paste</span>(., <span class="st">&quot;n&quot;</span>)</code></pre></div>
<pre><code>##  [1] &quot;10 n&quot; &quot;9 n&quot;  &quot;8 n&quot;  &quot;7 n&quot;  &quot;6 n&quot;  &quot;5 n&quot;  &quot;4 n&quot;  &quot;3 n&quot;  &quot;2 n&quot;  &quot;1 n&quot;</code></pre>
<p>O vetor (que não precisa necessariamente ser definido como uma variável) é primeiro ordenado de forma decrescente e, a partir dessa modificação, é transformado em um vetor de caracteres ao colar a string “n” a ele.</p>
<p>Uma forma de fazer isso sem usar <code>%&gt;%</code> seria:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="kw">order</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">decreasing =</span> T), <span class="st">&quot;vezes&quot;</span>)</code></pre></div>
<pre><code>##  [1] &quot;10 vezes&quot; &quot;9 vezes&quot;  &quot;8 vezes&quot;  &quot;7 vezes&quot;  &quot;6 vezes&quot;  &quot;5 vezes&quot; 
##  [7] &quot;4 vezes&quot;  &quot;3 vezes&quot;  &quot;2 vezes&quot;  &quot;1 vezes&quot;</code></pre>
<p><span style="color:blue"><strong>Pergunta</strong>: Na sua opinião, qual é o código mais fácil e rápido de ser entendido?</span></p>
<p>Como isso pode ser aplicado a data frames?</p>
<p>Voltando aos dados de Paracatu, vamos supor que você ainda não tenha lido esses dados, mas já saiba que o dia e a hora estão em colunas separadas e que você precisa juntá-los para calcular médias em períodos específicos. Além disso, você quer comparar a temperatura instantânea “temp_inst” com a média entre temperatura máxima “temp_max” e mínima “temp_min”. Então, precisamos:</p>
<ol style="list-style-type: decimal">
<li>Ler os dados<br />
</li>
<li>Juntas as colunas “data” e “hora”<br />
</li>
<li>Transformar a coluna resultante em <code>POSIXct</code><br />
</li>
<li>Calcular a média entre “temp_max” e “temp_min”<br />
</li>
<li>Comparar o que foi calculado com “temp_inst”</li>
</ol>
<p>Sem <code>%&gt;%</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
paracatu &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;dados/paracatu.csv&quot;</span>) <span class="co">#-- 1.</span>
paracatu &lt;-<span class="st"> </span><span class="kw">mutate</span>(paracatu, <span class="dt">data_completa =</span> <span class="kw">paste</span>(data, hora, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>)) <span class="co">#-- 2.</span>
paracatu &lt;-<span class="st"> </span><span class="kw">mutate</span>(paracatu, <span class="dt">data_completa =</span> <span class="kw">as.POSIXct</span>(data_completa, <span class="dt">format =</span> <span class="st">&quot;%d/%m/%Y-%H&quot;</span>)) <span class="co">#-- 3.</span>
paracatu &lt;-<span class="st"> </span><span class="kw">mutate</span>(paracatu, <span class="dt">temp_med =</span> (temp_max <span class="op">+</span><span class="st"> </span>temp_min)<span class="op">/</span><span class="dv">2</span>) <span class="co">#-- 4.</span>
paracatu &lt;-<span class="st"> </span><span class="kw">mutate</span>(paracatu, <span class="dt">temp_residuo =</span> temp_inst <span class="op">-</span><span class="st"> </span>temp_med) <span class="co">#-- 5.</span>
<span class="kw">summary</span>(paracatu)</code></pre></div>
<pre><code>##  codigo_estacao         data               hora             temp_inst    
##  Length:24          Length:24          Length:24          Min.   :14.50  
##  Class :character   Class :character   Class :character   1st Qu.:16.25  
##  Mode  :character   Mode  :character   Mode  :character   Median :19.40  
##                                                           Mean   :20.04  
##                                                           3rd Qu.:24.32  
##                                                           Max.   :26.40  
##     temp_max        temp_min      umid_inst           umid_max        
##  Min.   :15.50   Min.   :14.20   Length:24          Length:24         
##  1st Qu.:17.15   1st Qu.:15.38   Class :character   Class :character  
##  Median :19.75   Median :18.15   Mode  :character   Mode  :character  
##  Mean   :20.78   Mean   :19.26                                        
##  3rd Qu.:24.98   3rd Qu.:23.38                                        
##  Max.   :27.20   Max.   :26.20                                        
##    umid_min         pto_orvalho_inst   pto_orvalho_max   
##  Length:24          Length:24          Length:24         
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character  
##                                                          
##                                                          
##                                                          
##  pto_orvalho_min       pressao       pressao_max     pressao_min   
##  Length:24          Min.   :934.0   Min.   :934.1   Min.   :933.9  
##  Class :character   1st Qu.:934.7   1st Qu.:934.8   1st Qu.:934.4  
##  Mode  :character   Median :935.1   Median :935.4   Median :934.9  
##                     Mean   :935.3   Mean   :935.6   Mean   :935.1  
##                     3rd Qu.:935.6   3rd Qu.:936.0   3rd Qu.:935.4  
##                     Max.   :937.6   Max.   :937.7   Max.   :937.4  
##  vento_direcao     vento_vel       vento_rajada     radiacao      
##  Min.   :0.300   Min.   : 14.00   Min.   :0.80   Min.   :  -3.60  
##  1st Qu.:0.600   1st Qu.: 77.75   1st Qu.:1.85   1st Qu.:  -3.60  
##  Median :1.350   Median :209.00   Median :2.80   Median :  21.03  
##  Mean   :1.567   Mean   :177.96   Mean   :3.30   Mean   : 713.77  
##  3rd Qu.:2.450   3rd Qu.:256.00   3rd Qu.:4.60   3rd Qu.:1483.50  
##  Max.   :4.100   Max.   :355.00   Max.   :6.70   Max.   :2642.00  
##   precipitacao data_completa                    temp_med    
##  Min.   :0     Min.   :2018-06-01 00:00:00   Min.   :14.85  
##  1st Qu.:0     1st Qu.:2018-06-01 05:45:00   1st Qu.:16.21  
##  Median :0     Median :2018-06-01 11:30:00   Median :18.90  
##  Mean   :0     Mean   :2018-06-01 11:30:00   Mean   :20.02  
##  3rd Qu.:0     3rd Qu.:2018-06-01 17:15:00   3rd Qu.:24.18  
##  Max.   :0     Max.   :2018-06-01 23:00:00   Max.   :26.70  
##   temp_residuo     
##  Min.   :-1.60000  
##  1st Qu.:-0.35000  
##  Median : 0.02500  
##  Mean   : 0.02292  
##  3rd Qu.: 0.55000  
##  Max.   : 1.65000</code></pre>
<p>Note que sempre se mostra necessário salvar cada passo em uma nova variável ou, nesse caso, reciclar a mesma variável. Foi preciso uma linha para cada operação.</p>
<p>Já com <code>%&gt;%</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
paracatu &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;dados/paracatu.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#-- 1.</span>
<span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">data_completa =</span> <span class="kw">paste</span>(data, hora, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#-- 2.</span>
<span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">data_completa =</span> <span class="kw">as.POSIXct</span>(data_completa, <span class="dt">format =</span> <span class="st">&quot;%d/%m/%Y-%H&quot;</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#-- 3.</span>
<span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">temp_med =</span> (temp_max <span class="op">+</span><span class="st"> </span>temp_min)<span class="op">/</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#-- 4.</span>
<span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">temp_residuo =</span> temp_inst <span class="op">-</span><span class="st"> </span>temp_med) <span class="co">#-- 5.</span>
<span class="kw">summary</span>(paracatu)</code></pre></div>
<pre><code>##  codigo_estacao         data               hora             temp_inst    
##  Length:24          Length:24          Length:24          Min.   :14.50  
##  Class :character   Class :character   Class :character   1st Qu.:16.25  
##  Mode  :character   Mode  :character   Mode  :character   Median :19.40  
##                                                           Mean   :20.04  
##                                                           3rd Qu.:24.32  
##                                                           Max.   :26.40  
##     temp_max        temp_min      umid_inst           umid_max        
##  Min.   :15.50   Min.   :14.20   Length:24          Length:24         
##  1st Qu.:17.15   1st Qu.:15.38   Class :character   Class :character  
##  Median :19.75   Median :18.15   Mode  :character   Mode  :character  
##  Mean   :20.78   Mean   :19.26                                        
##  3rd Qu.:24.98   3rd Qu.:23.38                                        
##  Max.   :27.20   Max.   :26.20                                        
##    umid_min         pto_orvalho_inst   pto_orvalho_max   
##  Length:24          Length:24          Length:24         
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character  
##                                                          
##                                                          
##                                                          
##  pto_orvalho_min       pressao       pressao_max     pressao_min   
##  Length:24          Min.   :934.0   Min.   :934.1   Min.   :933.9  
##  Class :character   1st Qu.:934.7   1st Qu.:934.8   1st Qu.:934.4  
##  Mode  :character   Median :935.1   Median :935.4   Median :934.9  
##                     Mean   :935.3   Mean   :935.6   Mean   :935.1  
##                     3rd Qu.:935.6   3rd Qu.:936.0   3rd Qu.:935.4  
##                     Max.   :937.6   Max.   :937.7   Max.   :937.4  
##  vento_direcao     vento_vel       vento_rajada     radiacao      
##  Min.   :0.300   Min.   : 14.00   Min.   :0.80   Min.   :  -3.60  
##  1st Qu.:0.600   1st Qu.: 77.75   1st Qu.:1.85   1st Qu.:  -3.60  
##  Median :1.350   Median :209.00   Median :2.80   Median :  21.03  
##  Mean   :1.567   Mean   :177.96   Mean   :3.30   Mean   : 713.77  
##  3rd Qu.:2.450   3rd Qu.:256.00   3rd Qu.:4.60   3rd Qu.:1483.50  
##  Max.   :4.100   Max.   :355.00   Max.   :6.70   Max.   :2642.00  
##   precipitacao data_completa                    temp_med    
##  Min.   :0     Min.   :2018-06-01 00:00:00   Min.   :14.85  
##  1st Qu.:0     1st Qu.:2018-06-01 05:45:00   1st Qu.:16.21  
##  Median :0     Median :2018-06-01 11:30:00   Median :18.90  
##  Mean   :0     Mean   :2018-06-01 11:30:00   Mean   :20.02  
##  3rd Qu.:0     3rd Qu.:2018-06-01 17:15:00   3rd Qu.:24.18  
##  Max.   :0     Max.   :2018-06-01 23:00:00   Max.   :26.70  
##   temp_residuo     
##  Min.   :-1.60000  
##  1st Qu.:-0.35000  
##  Median : 0.02500  
##  Mean   : 0.02292  
##  3rd Qu.: 0.55000  
##  Max.   : 1.65000</code></pre>
<p>O código pode estar separado por linhas, mas perceba que, ao rodar qualquer linha desse conjunto, todo ele é rodado de uma vez!</p>
<p>Assim, adicionar um passo fica fácil. Por exemplo, as colunas “data” e “hora” não são mais necessárias:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
paracatu &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;dados/paracatu.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#-- 1.</span>
<span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">data_completa =</span> <span class="kw">paste</span>(data, hora, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#-- 2.</span>
<span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">data_completa =</span> <span class="kw">as.POSIXct</span>(data_completa, <span class="dt">format =</span> <span class="st">&quot;%d/%m/%Y-%H&quot;</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#-- 3.</span>
<span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">temp_med =</span> (temp_max <span class="op">+</span><span class="st"> </span>temp_min)<span class="op">/</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#-- 4.</span>
<span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">temp_residuo =</span> temp_inst <span class="op">-</span><span class="st"> </span>temp_med) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#-- 5.</span>
<span class="st">  </span><span class="kw">select</span>(., <span class="op">-</span><span class="kw">c</span>(data, hora)) <span class="co">#-- 6.</span>
<span class="kw">summary</span>(paracatu)</code></pre></div>
<pre><code>##  codigo_estacao       temp_inst        temp_max        temp_min    
##  Length:24          Min.   :14.50   Min.   :15.50   Min.   :14.20  
##  Class :character   1st Qu.:16.25   1st Qu.:17.15   1st Qu.:15.38  
##  Mode  :character   Median :19.40   Median :19.75   Median :18.15  
##                     Mean   :20.04   Mean   :20.78   Mean   :19.26  
##                     3rd Qu.:24.32   3rd Qu.:24.98   3rd Qu.:23.38  
##                     Max.   :26.40   Max.   :27.20   Max.   :26.20  
##   umid_inst           umid_max           umid_min        
##  Length:24          Length:24          Length:24         
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character  
##                                                          
##                                                          
##                                                          
##  pto_orvalho_inst   pto_orvalho_max    pto_orvalho_min       pressao     
##  Length:24          Length:24          Length:24          Min.   :934.0  
##  Class :character   Class :character   Class :character   1st Qu.:934.7  
##  Mode  :character   Mode  :character   Mode  :character   Median :935.1  
##                                                           Mean   :935.3  
##                                                           3rd Qu.:935.6  
##                                                           Max.   :937.6  
##   pressao_max     pressao_min    vento_direcao     vento_vel     
##  Min.   :934.1   Min.   :933.9   Min.   :0.300   Min.   : 14.00  
##  1st Qu.:934.8   1st Qu.:934.4   1st Qu.:0.600   1st Qu.: 77.75  
##  Median :935.4   Median :934.9   Median :1.350   Median :209.00  
##  Mean   :935.6   Mean   :935.1   Mean   :1.567   Mean   :177.96  
##  3rd Qu.:936.0   3rd Qu.:935.4   3rd Qu.:2.450   3rd Qu.:256.00  
##  Max.   :937.7   Max.   :937.4   Max.   :4.100   Max.   :355.00  
##   vento_rajada     radiacao        precipitacao
##  Min.   :0.80   Min.   :  -3.60   Min.   :0    
##  1st Qu.:1.85   1st Qu.:  -3.60   1st Qu.:0    
##  Median :2.80   Median :  21.03   Median :0    
##  Mean   :3.30   Mean   : 713.77   Mean   :0    
##  3rd Qu.:4.60   3rd Qu.:1483.50   3rd Qu.:0    
##  Max.   :6.70   Max.   :2642.00   Max.   :0    
##  data_completa                    temp_med      temp_residuo     
##  Min.   :2018-06-01 00:00:00   Min.   :14.85   Min.   :-1.60000  
##  1st Qu.:2018-06-01 05:45:00   1st Qu.:16.21   1st Qu.:-0.35000  
##  Median :2018-06-01 11:30:00   Median :18.90   Median : 0.02500  
##  Mean   :2018-06-01 11:30:00   Mean   :20.02   Mean   : 0.02292  
##  3rd Qu.:2018-06-01 17:15:00   3rd Qu.:24.18   3rd Qu.: 0.55000  
##  Max.   :2018-06-01 23:00:00   Max.   :26.70   Max.   : 1.65000</code></pre>
<p><span style="color:blue"><strong>Pergunta</strong>: E agora? Na sua opinião, qual é o código mais fácil e rápido de ser entendido?</span></p>
<hr />
<p><span style="color:red"><strong>Exercício</strong>: Crie um data frame dos dados de Paracatu com a data no formato <code>POSIXct</code> e os resíduos de temperatura, umidade e pressão. Em geral, qual grandeza tem maior resíduo?</span></p>
<hr />
</div>
</div>
<div id="outros-tipos-de-dados" class="section level2">
<h2><span class="header-section-number">4.3</span> Outros Tipos de Dados</h2>
<div id="netcdf" class="section level3">
<h3><span class="header-section-number">4.3.1</span> NetCDF</h3>
<p>O NetCDF (Network Common Data Form) é um conjunto de bibliotecas de software e formatos de dados independentes de máquina e autodescritivos com suporte para criação, acesso e compartilhamento de dados científicos orientados a matrizes. Arquivos NetCDF (criado por essa biblioteca ou por programas que utilizam essa biblioteca) são arquivos compostos por dados, atributos e metadados.</p>
<p>O pacote <code>ncdf4</code> é um exemplo de interface do R com a biblioteca NetCDF 4, os comandos abaixo instalam e carregam esse pacote:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;ncdf4&quot;) # instala o pacote</span>
<span class="kw">library</span>(<span class="st">&quot;ncdf4&quot;</span>)           <span class="co"># carrega o pacote</span>
<span class="kw">nc_version</span>()               <span class="co"># versão da biblioteca</span></code></pre></div>
<pre><code>## [1] &quot;ncdf4_1.16_20170401&quot;</code></pre>
<p>Um exemplo de NetCDF:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">edgar &lt;-<span class="st"> </span><span class="kw">nc_open</span>(<span class="dt">filename =</span> <span class="st">&quot;dados/v431_v2_REFERENCE_CO_2010_10_AGR.0.1x0.1.nc&quot;</span>)</code></pre></div>
<p>O objeto <code>edgar</code> contém algumas informações sobre o conteúdo do arquivo, com um <code>print(edgar)</code> ou simplesmente <code>edgar</code> visualizamos o conteúdo do arquivo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(edgar)
edgar</code></pre></div>
<p>Isso mostra o nome do arquivo (e versão da biblioteca usada para criar), número de variáveis (1 variável neste exemplo), uma descrição de cada variável (incluindo atributos) as dimensões (2 para esse arquivo) e atributos globais.</p>
<p>Agora vamos abrir alguma variável:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(edgar<span class="op">$</span>var)
co &lt;-<span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">ncvar_get</span>(edgar, <span class="st">&quot;emi_co&quot;</span>)  
<span class="kw">class</span>(co)</code></pre></div>
<p>Como o NetCDF é organizado para guardar matrizes (arrays), só sabemos que a variável <code>emi_co</code> é um array</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncatt_get</span>(edgar,<span class="st">&quot;emi_co&quot;</span>) <span class="co"># ou ncatt_get(edgar,&quot;emi_co&quot;,verbose = T)</span></code></pre></div>
<p>repete a informação do print anterior, mas sem os atributos globais:</p>
<pre><code># $standard_name
# [1] &quot;tendency_of_atmosphere_mass_content_of_carbon_monoxide_due_to_emission&quot;
# $long_name
# [1] &quot;Emissions of CO - &quot;
# $units
# [1] &quot;kg m-2 s-1&quot;
# $cell_method
# [1] &quot;time: mean (interval: 1 month,  31 days)&quot;
# $total_emi_co
# [1] &quot;   6.32889e+009 kg/month&quot;
# $comment
# [1] &quot; (see http://edgar.jrc.ec.europa.eu/methodology.php#12sou for the definitions of the single sources)&quot;</code></pre>
<p>A latitude de cada ponto de grade, assim como longitude níveis (tempo em outros casos) o podem ser extraídas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lat  &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(wrf, <span class="st">&quot;lat&quot;</span>)
lon  &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(wrf, <span class="st">&quot;lon&quot;</span>)</code></pre></div>
<p>O metadado de Longitude também pode conter informações úteis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncatt_get</span>(edgar,<span class="st">&quot;lon&quot;</span>)
<span class="co"># $standard_name</span>
<span class="co"># [1] &quot;longitude&quot;</span>
<span class="co"># $long_name</span>
<span class="co"># [1] &quot;longitude&quot;</span>
<span class="co"># $units</span>
<span class="co"># [1] &quot;degrees_east&quot;</span>
<span class="co"># $comment</span>
<span class="co"># [1] &quot;center_of_cell&quot;</span></code></pre></div>
<p>e Latitude:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncatt_get</span>(edgar,<span class="st">&quot;lat&quot;</span>)
<span class="co"># $standard_name</span>
<span class="co"># [1] &quot;latitude&quot;</span>
<span class="co"># $long_name</span>
<span class="co"># [1] &quot;latitude&quot;</span>
<span class="co"># $units</span>
<span class="co"># [1] &quot;degrees_north&quot;</span>
<span class="co"># $comment</span>
<span class="co"># [1] &quot;center_of_cell&quot;</span></code></pre></div>
<p>e também os atributos globais podem ser acessados separadamante:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncatt_get</span>(edgar,<span class="dt">varid =</span> <span class="dv">0</span>)
<span class="co"># $Conventions</span>
<span class="co"># [1] &quot;CF-1.0&quot;</span>
<span class="co"># $title</span>
<span class="co"># [1] &quot;Monthly Mean (October) Emissions of CO - &quot;</span>
<span class="co"># $institution</span>
<span class="co"># [1] &quot;European Commission, Joint Research Centre&quot;</span>
<span class="co"># $source</span>
<span class="co"># [1] &quot;http://edgar.jrc.ec.europa.eu/&quot;</span>
<span class="co"># $history</span>
<span class="co"># [1] &quot;Created from original data (0.1x0.1 degrees) using IDL program (edgar_ascii_to_ncdf.pro) on Wed Jun 29 13:29:58 2016&quot;</span>
<span class="co"># $references</span>
<span class="co"># [1] &quot;European Commission, Joint Research Centre (JRC)/Netherlands Environmental Assessment Agency (PBL). Emission Database for Global Atmospheric Research (EDGAR),http://edgar.jrc.ec.europe.eu&quot;</span>
<span class="co"># $copyright_notice</span>
<span class="co"># [1] &quot;Reproduction of the data is authorized, except for commercial purposes, provided the source is fully acknowledged in the from\&quot;Source: European Commission, Joint Research Centre (JRC)/Netherlands Environmental Assessment Agency (PBL). Emission Databasefor Global Atmospheric Research (EDGAR), http://edgar.jrc.ec.europe.eu\&quot;. Where reproduction is on a web-site,at least one link to http://edgar.jrc.ec.europa.eu, should be provided and maintained. Where prior permission must be obtained for thereproduction or use of textual and multimedia information (sound, images, software, etc.), such permission shall cancel the above-mentionedgeneral permission and shall clearly indicate any restrictions on use.&quot;</span>
<span class="co"># $contact</span>
<span class="co"># [1] &quot;edgar-info@jrc.ec.europa.eu&quot;</span></code></pre></div>
<p>Da mesma forma com que podemos acessar variáveis e atributos com <code>ncvar_get</code> e <code>ncatt_get</code>, podemos modificar estes valores com <code>ncvar_put</code> e <code>ncatt_put</code>. Outras operações como renomear (<code>ncvar_rename</code>) e trocar o valor de missval (<code>ncvar_change_missval</code>) também estão disponíveis.</p>
<p><em>DICA</em>: <code>ncatt_get</code> e <code>ncatt_put</code> acessam e alteram os atributos de váriaveis e também atributos globais do NetCDF usando o argumento <code>varid=0</code> como no código mostrado anteriormente.</p>
<p>Para salvar as alterações e/ou liberar o acesso ao arquivo use a função <code>nc_close</code> (ou a função <code>nc_sync</code> que sincroniza o NetCDF mas não fecha a conexão com o arquivo).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nc_close</span>(edgar) <span class="co"># ou nc_sync(edgar)</span></code></pre></div>
<p>O pacote possue ainda funções mais específicas para a criação de arquivos em NetCDF como <code>nc_create</code>, funções que definem dimenções como <code>ncdim_def</code> e funções para colocar e tirar o arquivo de modo de definição <code>nc_redef</code> e <code>nc_enddef</code>.</p>
<p><em>DICA</em>: o NetCDF no R funciona de forma parecida com ouma lista ou data frame, podemos “ver” ou selecionar suas sub-partes (sub-sub-partes…) com “$” e TAB.</p>
</div>
<div id="dados-binarios" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Dados Binários</h3>
<p>O <code>R</code> lê e escreve dados binários usando as funções <code>readBin</code> e <code>writeBin</code>, respectivamente.</p>
<p><strong>Ler dados binários no R</strong></p>
<p>Em meteorologia, frequentemente os dados estão em formato binário. A maior “dificuldade” em ler estes dados está em conhecer como eles foram gerados. Neste curso, o arquivo binário que vamos abrir como exemplo contém dados de temperatura de brilho obtidas com o satélite GOES-13 (informações em: <a href="https://disc.gsfc.nasa.gov/datasets/GPM_MERGIR_1/summary" class="uri">https://disc.gsfc.nasa.gov/datasets/GPM_MERGIR_1/summary</a>).</p>
<p>Lembrem-se de baixar o dado em: <a href="https://github.com/iagdevs/cursoR/tree/master/dados" class="uri">https://github.com/iagdevs/cursoR/tree/master/dados</a></p>
<p>Repare que a função <code>readBin</code> requer alguns argumentos para ler estes dados da forma correta:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(readBin)</code></pre></div>
<pre><code>## function (con, what, n = 1L, size = NA_integer_, signed = TRUE, 
##     endian = .Platform$endian) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Lembre-se de usar ?readBin</span></code></pre></div>
<p>O que são estes argumentos?</p>
<ul>
<li><code>con</code> é um objeto de conexão ou um string de caracteres nomeando um arquivo.</li>
<li><code>what</code> é um string de caracteres que indica o modo dos dados a serem lidos. Pode ser um “numeric”, “double”, “integer”, “int”, “logical”, “complex”, or “character”.</li>
<li><code>n</code> um inteiro especificando o número máximo de valores a serem lidos.</li>
<li><code>size</code> um inteiro especificando o número de bytes por valor lido. O padrão de NA_integer_ usa um tamanho padrão para um valor do modo (what) especificado (4 para “integer”, 8 para “double” e 16 para “complex”. Este argumento é ignorado para dados “character”. Neste caso, os dados de caracteres são lidos como sequências de caracteres de byte único terminadas em nulo.</li>
<li><code>signed</code> é um valor lógico. Usado apenas para números “integer” de tamanhos 1 e 2. Se TRUE (por default), “integers” são considerados como números inteiros assinados.</li>
<li><code>endian</code> é um string de caracteres. Se endian = “big” ou se endian = “little”, especifica-se a extremidade (endian-ness) dos valores lidos ou escritos. Se endian=“swap” a extremidade é trocada. Hardware Intel é “little” endian e hardware Sun é “big” endian.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Ler o arquivo binário: readBin</span>
l1 &lt;-<span class="st"> </span><span class="kw">readBin</span>(<span class="st">&quot;dados/gs.140422.1900g.ch4&quot;</span>, 
              <span class="dt">what=</span><span class="st">&quot;int&quot;</span>, 
              <span class="dt">n =</span> <span class="dv">1349</span><span class="op">*</span><span class="dv">1613</span>,
              <span class="dt">size =</span> <span class="dv">2</span>,
              <span class="dt">signed =</span> T,
              <span class="dt">endian =</span> <span class="st">&quot;little&quot;</span>)
<span class="kw">class</span>(l1)</code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<p>Uma forma rápida para verificarmos os nossos dados é gráfica. Logo, que tal um plot?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(l1, <span class="dt">ncol=</span><span class="dv">1613</span>, <span class="dt">nrow=</span><span class="dv">1349</span>)
<span class="kw">class</span>(l2)</code></pre></div>
<pre><code>## [1] &quot;matrix&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Vamos chamar o pacote cptcity para selecionar facilmente uma paleta de cores legal.</span>
<span class="kw">library</span>(cptcity)   
<span class="kw">image</span>(l2,
      <span class="dt">col =</span> <span class="kw">cpt</span>(<span class="kw">find_cpt</span>(<span class="st">&quot;sat&quot;</span>)[<span class="dv">8</span>]),
      <span class="dt">main =</span> <span class="st">&quot;Temperatura de brilho&quot;</span>) </code></pre></div>
<p><img src="cursoR_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>Tem algo estranho com esta imagem. O que é? (valendo um sticker).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raster, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)
l3 &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">t</span>(l2[<span class="dv">1</span><span class="op">:</span><span class="dv">1349</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">1613</span>]),
                     <span class="dt">xmn=</span><span class="op">-</span><span class="fl">82.00</span>,
                     <span class="dt">ymn=</span><span class="op">-</span><span class="fl">44.96</span>,
                     <span class="dt">xmx=</span><span class="op">-</span><span class="fl">82.0</span>  <span class="op">+</span><span class="st"> </span>(<span class="fl">0.03593245</span><span class="op">*</span><span class="dv">1349</span>), 
                     <span class="dt">ymx=</span><span class="op">-</span><span class="fl">44.96</span> <span class="op">+</span><span class="st"> </span>(<span class="fl">0.03593245</span><span class="op">*</span><span class="dv">1613</span>),
                     <span class="dt">crs =</span> <span class="kw">CRS</span>(<span class="st">&quot;+init=epsg:4326&quot;</span>))
<span class="kw">class</span>(l3)</code></pre></div>
<pre><code>## [1] &quot;RasterLayer&quot;
## attr(,&quot;package&quot;)
## [1] &quot;raster&quot;</code></pre>
<p>O capítulo geoespacial será visto no final deste curso. Porém, nesta etapa vamos usar o pacote <code>raster</code> somente para analisar se os dados binários foram lidos corretamente.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sp<span class="op">::</span><span class="kw">spplot</span>(((l3 <span class="op">+</span><span class="st"> </span><span class="dv">75</span>)<span class="op">/</span><span class="dv">100</span>)<span class="op">-</span><span class="dv">273</span>, <span class="co"># Estas correções são necessárias. Veja: http://www.cpc.ncep.noaa.gov/products/global_precip/html/README</span>
           <span class="dt">col.regions =</span> <span class="kw">cpt</span>(<span class="kw">find_cpt</span>(<span class="st">&quot;sat&quot;</span>)[<span class="dv">8</span>]),
           <span class="dt">at =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">80</span>,<span class="dv">0</span>,<span class="dv">1</span>),
           <span class="dt">main =</span> <span class="st">&quot;Temperatura de brilho (ºC)&quot;</span>) </code></pre></div>
<p><img src="cursoR_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p><strong>Escrever dados binários no R</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Escrever um arquivo binário: writeBin</span>
<span class="kw">args</span>(writeBin)</code></pre></div>
<pre><code>## function (object, con, size = NA_integer_, endian = .Platform$endian, 
##     useBytes = FALSE) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Lembre-se de usar ?writeBin</span></code></pre></div>
<p><code>useBytes</code> um valor lógico. No <code>R</code>, se FALSE (o default), especifica que writeBin converteria strings com codificações para uma string imprimível antes de escrever os bytes. Se TRUE, especifica que writeBin escreveria os bytes do string não convertidos.</p>
<p><code>object</code> um objeto escrito no <code>con</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Na linha abaixo vamos criar um arquivo temporário com o auxílio da função &quot;tempfile&quot; </span>
<span class="co"># para depois escrever os dados dentro deste arquivo.</span>
tf &lt;-<span class="st"> </span><span class="kw">tempfile</span>()
<span class="co"># Vamos atribuir a &quot;tb&quot; os 20 primeiros valores de l1 (temperatura de brilho).</span>
tb &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">21000</span>, <span class="dv">21000</span>, <span class="dv">20800</span>, <span class="dv">21000</span>, <span class="dv">20800</span>, <span class="dv">20700</span>, <span class="dv">20600</span>, <span class="dv">20600</span>, <span class="dv">20900</span>, <span class="dv">20900</span>, 
        <span class="dv">20900</span>, <span class="dv">20900</span>, <span class="dv">20700</span>, <span class="dv">20500</span>, <span class="dv">20500</span>, <span class="dv">20400</span>, <span class="dv">20500</span>, <span class="dv">20700</span>, <span class="dv">20400</span>, <span class="dv">20300</span>)
<span class="kw">class</span>(tb)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">as.integer</span>(tb)
<span class="kw">writeBin</span>(x, <span class="dt">con =</span> tf)

<span class="co"># Agora vamos ler o arquivo binário escrito acima. Você lembra quais são os argumentos para ler binário?</span>
<span class="kw">readBin</span>(tf,
        <span class="dt">what =</span> <span class="st">&quot;integer&quot;</span>,
        <span class="dt">n =</span> <span class="dv">20</span>)</code></pre></div>
<pre><code>##  [1] 21000 21000 20800 21000 20800 20700 20600 20600 20900 20900 20900
## [12] 20900 20700 20500 20500 20400 20500 20700 20400 20300</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotando.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/iagdevs/cursoR/edit/master/03-import_export.Rmd",
"text": "Edit"
},
"download": ["cursoR.pdf", "cursoR.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
