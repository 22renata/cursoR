# R! {#r}


- Iremos focar no Linux, mas R e RStudio estão disponíveis para Windows e Mac também.
- Documentação:
- [Intro](http://cran.r-project.org/doc/manuals/r-release/R-intro.html).
- [I/O](http://cran.r-project.org/doc/manuals/r-release/R-data.html).
- Quer fazer um pacote? [Veja](http://cran.r-project.org/doc/manuals/r-release/R-exts.html),
[aqui](http://cran.r-project.org/doc/manuals/r-release/R-ints.html) e [aqui](http://cran.r-project.org/doc/manuals/r-release/R-lang.html).
- [Stackoverflow](https://stackoverflow.com/questions/tagged/r) te ajudará em horas de desespero.

## Objetos do R

- Character `r "a"`
- Numeric `r 1`
- Integer `r 1`
- Complex `r 1i`
- Logical `r TRUE`

## Classe

`class` essa função permite ver a classe dos objetos

## Vetores

- c("A", "C", "D")
- 1:5 = c(1, 2, 3, 4, 5)
- c(TRUE, FALSE)
- c(1i, -1i)
- c(1, "C", "D") qual é a classe???
- c(1, NA, "D") qual é a classe???
- c(1, NA, NaN) qual é a classe???

## Converter objetos 

### `as`

```{r}
as.numeric(c(1, "C", "D"))
```

### `merge` e `melt` {#convert_df}

## Matrizes e a função `matrix`

**[linhas, colunas]**

- Só são permitidos elementos **da mesma clase**!

Argumentos da função `matrix`

```{r}
args(matrix)
```

usando TAB

```{r}
(m <- matrix(data = 0, nrow = 4, ncol = 4))
```


```{r}
(m1 <- matrix(data = 1:(4*4), nrow = 4, ncol = 4))
dim(m1)
```


```{r}
(m2 <- matrix(data = 1:(4*4), nrow = 4, ncol = 4, byrow = TRUE))
```

## Array

Permite armazenar diversos elementos, com diversas dimensões. Dessa forma, um array com duas dimensões é o mesmo que uma matriz, dessa forma, podemos armazenar diversas matrizes dentro de um array, mas suas dimensões são pré-estabelecidas.

```{r}
args(array)
```

Não esqueça do TAB

```{r}
(a <- array(data = 0, dim = c(1,1)))
class(a)
```

```{r}
(a <- array(data = 0, dim = c(1,1,1)))
class(a)
```



```{r}
(a <- array(data = 0, dim = c(2,2,2)))
```


```{r}
(a <- array(data = 0, dim = c(2,4,4)))
dim(a)
```


```{r eval = FALSE}
(a <- array(data = 0, dim = c(2, 2,2,2)))
```

## `list`

Já as listas permitem que você armazene qualquer tipo de ojeto, independente da classe, dessa forma, podemos colocar numa lista: número, caracteres, argumentos lógicos, ou que você quiser:

```{r}
list(list(list(list(1))))
```
Isso faz com que elas sejam bastante versáteis e sirvam para armazenar o que você precisar, mas elas só podem ter uma dimensão, como uma fila.

```{r}
(x <- list(1, "a", TRUE, 1 + 4i))
```

## Tempo e Data

R também tem classes de tempo e data:

```{r}
(a <- ISOdate(year = 2018, month = 4, day = 5))
class(a)
(b <- ISOdate(year = 2018, month = 4, day = 5, tz = "Americas/Sao_Paulo"))
```

Tempo

```{r}
(d <- ISOdatetime(year = 2018, month = 4, day = 5, hour = 0, min = 0, sec = 0,
                  tz = "Americas/Sao_Paulo"))
```

Caso você precise, o pacote [nanotime](https://github.com/eddelbuettel/nanotime) permite trabalhar com nano segundos.

É possível fazer sequências:

```{r}
hoje <- Sys.time()
(a <- seq.POSIXt(from = hoje, by = 3600, length.out = 24))

```

funções úteis: **weekdays**, **month**, **julian**

```{r}
weekdays(a)
months(a)
julian(a) #dia Juliano*
```
*Para mais informações: https://en.wikipedia.org/wiki/Julian_day:



## Fatores

Os `factors` podem ser um pouco infernais. Dê uma olhada em [R INFERNO](http://www.burns-stat.com/documents/books/the-r-inferno/)

São variáveis que representam categorias, como por exemplo, dias da semana.

```{r}
a <- seq.POSIXt(from = hoje, by = 3600, length.out = 24*7)
aa <- weekdays(a)
class(aa)
factor(aa)
```
São muito úteis para regressões, plotes e resumos estatísitcos.

Olhe os **Levels**

Então: 

```{r}
ab <- factor(x = aa,
             levels = c("Monday", "Tuesday",  "Wednesday",  "Thursday",
                        "Friday", "Saturday", "Sunday"))
levels(ab)
```

## Paste!!

Como concatenar, juntar, grudar arquivos, palavras, etc etc... é com `paste` e
`paste0`. Estas funções são muito simples mas muito úteis!!!

```{r}
args(paste0)
```

```{r}
args(paste)
```


A diferença entre `paste0` e `paste`, é que `paste0` não tem uma separação
de characteres por default, mas `paste` usa espaço.

```{r}
path <- getwd()
nome <- "SeuNome"
paste(path, nome)
paste0(path, nome)
paste(path, "/", nome)
paste(path, "/-/_****;;;////", nome)
class(paste(path, "/-/_****;;;////", nome))
paste0(nome, "_", 1:10) #Função vetorizada
paste0(1:10) #Função vetorizada
class(paste0(1:10))
```

## Substituindo caracteres

Vamos supor que tu vai ler um banco de dados, e uma coluna tem o character "BB".
Vamos supor que nessa coluna tem um numero, mas tu precisa **remover** o simbolo
"BB" para logo convertir para numero. A função que vamos usar que podemos usar é
`gsub`.

```{r}
numeros <- 1:50
b <- round(runif(n = 10, min = 1, max = 50))
numeros[b] <- paste0(numeros, "BB")
numeros
```


```{r}
args(gsub)
```


```{r}
nn <- gsub(pattern = "BB", replacement = "", x = numeros)
class(nn)
as.numeric(nn)
```

## Substraindo caracteres


Agora vamos supor que temos grudado ultimo character com BB, A função que vamos usar
é `substr`:

```{r}
args(substr)
```

Com `x` é o vetor, `start` primeiro elemento em ser reemplazado e `stop` ultimo
elemento em ser reemplazado

Vamos super uma sequenciea de 1 ate 10 e tem grudados as letras BB

```{r}
(numeros<- paste0(1:9, "BB"))
```

Para remover os ultimos dois characters sería:
```{r}
substr(numeros, 0, 1)
substr(numeros, 2, 3)
```


## Data.frames

_lembre ?data.frame_

Lembram uma planilha EXCEL... Mais ou menos


É uma classe bem especial, tem elementos de matriz mas o modo é lista
```{r}
args(data.frame)
```



```{r}
(df <- data.frame(a = 1:3))
names(df)
class(df)
mode(df)
```

Podemos utilizar para armazenar dados, sendo que um data.frame é sempre composto por vetores com comprimento IGUAL

```{r}
nrow(df)
ncol(df)
dim(df)
```

Algumas operações que pode fazer com data.frames são:

- rbind: une verticalmente (por linhas... row) duas data.frames
- cbind: Une horizontalmente duas data.frames por colunas
- merge: Une horizontalmente data.frames por coincidencia de dados nas colunas

faza?

```{r}
?rbind
?cbind
?merge
```


Exemplo:

```{r}
a <- data.frame(id = c("a", "b", "c"))
b <- data.frame(id = c("Z", "b", "D"))
merge(x = a, y = b, by = "id")
```

